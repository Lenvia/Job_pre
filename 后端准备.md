[TOC]

## 操作系统

### 进程、线程、协程

#### 进程、线程、协程的区别【4】

线程与进程的比较如下：

- 进程是资源（包括内存、打开的文件等）分配的单位，线程是 CPU 调度的单位；
- 进程拥有一个完整的资源平台，而线程只独享必不可少的资源，如寄存器和栈；
- 线程同样具有就绪、阻塞、执行三种基本状态，同样具有状态之间的转换关系；
- 线程能减少并发执行的时间和空间开销；
  - 线程的创建时间比进程快（不会涉及这些资源管理信息）
  - 线程的终止时间比进程快（释放的资源相比进程少）
  - 同一个进程内的线程切换比进程切换快（虚拟内存共享）
  - 线程之间数据传递的时候，就不需要经过内核



#### 什么时候用线程，什么时候用协程





#### 共享内存的实现方式





### 进程

####  进程状态【2】

在一个进程的活动期间至少具备三种基本状态，即运行状态、就绪状态、阻塞状态。

- 运行状态（*Running*）：该时刻进程占用 CPU；
- 就绪状态（*Ready*）：可运行，由于其他进程处于运行状态而暂时停止运行；
- 阻塞状态（*Blocked*）：该进程正在等待某一事件发生（如等待输入/输出操作的完成）而暂时停止运行，这时，即使给它CPU控制权，它也无法运行；

进程还有另外两个基本状态：

- 创建状态（*new*）：进程正在被创建时的状态；
- 结束状态（*Exit*）：进程正在从系统中消失时的状态；

<img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h7wsycw76wj31fe0hy402.jpg" alt="截屏2022-11-07 19.46.47" style="zoom:33%;" />

在虚拟内存管理的操作系统中，通常会把阻塞状态的进程的物理内存空间换出到硬盘，等需要再次运行的时候，再从硬盘换入到物理内存。就需要一个新的状态，来**描述进程没有占用实际的物理内存空间的情况，这个状态就是挂起状态**。

挂起状态可以分为两种：

- 阻塞挂起状态：进程在外存（硬盘）并等待某个事件的出现；
- 就绪挂起状态：进程在外存（硬盘），但只要进入内存，即刻立刻运行；

<img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h7wt4wmlp9j31bg0u0mzr.jpg" alt="截屏2022-11-07 19.53.04" style="zoom:33%;" />



#### 进程间通信【2】

每个进程的用户地址空间都是独立的，一般而言是不能互相访问的，但内核空间是每个进程都共享的，所以进程之间要通信必须通过内核。

**管道、消息队列、共享内存、信号量、套接字**

- 管道

  管道传输数据是单向的。A进程将数据以字节流写入管道，B进程需要等待A进程将信息写完以后才能读出来。

  比如 ps -f | grep xxx

  缺点：效率低，不适合进程间频繁地交换数据

- 消息队列

  在发送数据时，按照一个个独立单元发送，发送方和接收方约定好消息的类型和格式

  缺点：不适合比较大数据的传输；存在用户态与内核态之间的数据拷贝开销

- 共享内存

  申请一块虚拟地址空间，不同进程通过这块虚拟地址空间映射到相同的物理地址空间。无需拷贝。

  缺点：会出现冲突

- 信号量

  防止多进程竞争共享资源，而造成的数据错乱的一个约束和保护机制。使得共享的资源，在任意时刻只能被一个进程访问。

  信号量表示资源的数量，控制信号量的方式有两种原子操作：P 操作和 V 操作。P 操作为申请资源，V 操作是归还资源。

  信号初始化为 1，就代表着是**互斥信号量**，它可以保证共享内存在任何时刻只有一个进程在访问；信号初始化为 0，就代表着是**同步信号量**，它可以保证进程 A 应在进程 B 之前执行

- 信号

  信号是进程间通信机制中唯一的**异步通信机制**，因为可以在任何时候发送信号给某一进程，一旦有信号产生，就有下面这几种，用户进程对信号的处理方式：

  - 执行默认操作。Linux 对每种信号都规定了默认操作，例如，上面列表中的 SIGTERM 信号，就是终止进程的意思。
  - 捕捉信号。我们可以为信号定义一个信号处理函数。当信号发生时，我们就执行相应的信号处理函数。
  - 忽略信号。当我们不希望处理某些信号的时候，就可以忽略该信号，不做任何处理。有两个信号是应用进程无法捕捉和忽略的，即 `SIGKILL` 和 `SEGSTOP`，它们用于在任何时候中断或结束某一进程

- 套接字

  跨网络与不同主机上的进程之间通信

  domain 参数用来指定协议族、type 参数用来指定通信特性、protocal 参数原本是用来指定通信协议的（废弃）

  - TCP 协议通信的 socket 编程模型

    服务端和客户端初始化 socket -> 服务端 bind 绑定 IP 和端口 -> 服务端调用 listen 监听 -> 服务端调用 accept 等待客户端连接 -> 客户端调用 connect 发起连接请求 -> **服务端 accept 返回用于传输 socket 的文件描述符** -> 客户端 write 服务端read 

  - UDP 协议通信的 socket 编程模型

    只要有一个 socket 多台机器就可以任意通信，因此每一个 UDP 的 socket 都需要 bind

  - 本地进程间通信的 socket 编程模型

    本地字节流 socket 和 本地数据报 socket 在 bind 的时候，不像 TCP 和 UDP 要绑定 IP 地址和端口，而是绑定一个本地文件，这也就是它们之间的最大区别



#### 进程调度算法

- 先来先服务调度算法

  每次从就绪队列选择最先进入队列的进程，然后一直运行，直到进程退出或被阻塞，才会继续从队列中选择第一个进程接着运行。

- 最短作业优先调度算法

  优先选择运行时间最短的进程来运行，这有助于提高系统的吞吐量。

- 高响应比优先调度算法

  每次进行进程调度时，先计算「响应比优先级」，然后把「响应比优先级」最高的进程投入运行

  <img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h7wtlcdnq5j314w0bqmy7.jpg" alt="截屏2022-11-07 20.08.52" style="zoom:25%;" />

  （高响应比优先调度算法是「理想型」的调度算法，现实中是实现不了的）

- 时间片轮转调度算法

  每个进程被分配一个时间段，称为时间片（Quantum），即允许该进程在该时间段中运行。

  - 如果时间片用完，进程还在运行，那么将会把此进程从 CPU 释放出来，并把 CPU 分配给另外一个进程；
  - 如果该进程在时间片结束前阻塞或结束，则 CPU 立即进行切换；

- 最高优先级调度算法

  从就绪队列中选择最高优先级的进程进行运行。

  进程的优先级可以分为，静态优先级和动态优先级：

  - 静态优先级：创建进程时候，就已经确定了优先级了，然后整个运行时间优先级都不会变化；
  - 动态优先级：根据进程的动态变化调整优先级，比如如果进程运行时间增加，则降低其优先级，如果进程等待时间（就绪队列的等待时间）增加，则升高其优先级，也就是随着时间的推移增加等待进程的优先级。

- 多级反馈队列调度算法

  多级反馈队列（Multilevel Feedback Queue）调度算法是「时间片轮转算法」和「最高优先级算法」的综合和发展。

  <img src="https://tva1.sinaimg.cn/large/008vxvgGgy1h7wtpuf9qaj315w0u040o.jpg" alt="截屏2022-11-07 20.13.11" style="zoom:33%;" />

  - 设置了多个队列，赋予每个队列不同的优先级，每个**队列优先级从高到低**，同时**优先级越高时间片越短**；
  - 新的进程会被放入到第一级队列的末尾，按先来先服务的原则排队等待被调度，如果在第一级队列规定的时间片没运行完成，则将其转入到第二级队列的末尾，以此类推，直至完成；
  - 当较高优先级的队列为空，才调度较低优先级的队列中的进程运行。如果进程运行时，有新进程进入较高优先级的队列，则停止当前运行的进程并将其移入到原队列末尾，接着让较高优先级的进程运行；









### 线程

线程的优点：

- 一个进程中可以同时存在多个线程；
- 各个线程之间可以并发执行；
- 各个线程之间可以共享地址空间和文件等资源；

线程的缺点：

- 当进程中的一个线程崩溃时，会导致其所属进程的所有线程崩溃（C、C++里会，Java不会 。JVM 自定义了自己的信号处理函数，拦截了 SIGSEGV 信号，针对这两者不让它们崩溃。）



主要有三种线程的实现方式：

- **用户线程（\*User Thread\*）**：在用户空间实现的线程，不是由内核管理的线程，是由用户态的线程库来完成线程的管理；
- **内核线程（\*Kernel Thread\*）**：在内核中实现的线程，是由内核管理的线程；
- **轻量级进程（\*LightWeight Process\*）**：在内核中来支持用户线程；





#### 为什么要有多线程？





### 调度

#### ⚠️操作系统有哪些调度算法【3】

- **进程调度**（详见上文进程调度算法）
  - 先来先服务调度算法
  - 最短作业优先调度算法
  - 高响应比优先调度算法
  - 时间片轮转调度算法
  - 最高优先级调度算法
  - 多级反馈队列调度算法
- **内存页面置换算法**
  - 最佳页面置换算法
  - 先进先出置换算法
  - 最近最久未使用（LRU）的置换算法
  - 时钟页面置换算法
  - 最不常用（LFU）算法
- **磁盘调度算法**
  - 先来先服务
  - 最短寻道时间优先
  - 扫描算法
  - 循环扫描算法
  - LOOK 与 C-LOOK 算法





#### 知道LRU吗？简单说一下如何实现LRU





#### 操作系统的中断

中断是系统用来响应硬件设备请求的一种机制，操作系统收到硬件的中断请求，会打断正在执行的进程，然后调用内核中的中断处理程序来响应请求。

中断处理程序在响应中断时，可能还会「临时关闭中断」，这意味着，如果当前中断处理程序没有执行完之前，系统中其他的中断请求都无法被响应，也就说中断有可能会丢失，所以中断处理程序要短且快。

为了解决中断处理程序执行过长和中断丢失的问题，将中断过程分成了两个阶段，分别是「上半部和下半部分」。

- **上半部用来快速处理中断**，一般会暂时关闭中断请求，主要负责处理跟硬件紧密相关或者时间敏感的事情。
- **下半部用来延迟处理上半部未完成的工作**，一般以「内核线程」的方式运行。



#### 操作系统的并发了解吗



### 锁

https://www.xiaolincoding.com/os/4_process/pessim_and_optimi_lock.html#%E4%BA%92%E6%96%A5%E9%94%81%E4%B8%8E%E8%87%AA%E6%97%8B%E9%94%81

#### 死锁怎么产生的？怎么避免？

死锁：两个或两个以上线程都在等待对方执行完毕**释放锁**，在没有外力的作用下，这些线程会一直相互等待，就没办法继续运行，这种情况就是发生了**死锁**。

四个必要条件：

1. 互斥条件：一个资源只能被一个进程所使用
2. 请求与保持条件：一个进程因请求资源而阻塞时，对已获得的资源保持不放
3. 不可抢占条件：进程已获得的资源，在未使用完之前，不能强行剥夺
4. 循环等待条件：若干进程之间形成一种头尾相接的循环等待资源的关系





**如何解决？**

最常见：**使用资源有序分配法，来破循环与等待条件**。

（互斥不可破坏）

（不可抢占条件破坏代价大，实现复杂）

- 破坏请求与保持条件：

  允许进程获取初期所有资源后，便开始运行，运行过程中再逐步释放自己占有的资源

- 破坏循环与等待条件：

  对各进程请求资源的顺序做一个规定，避免相互等待。线程 A 和 线程 B 总是以相同的顺序申请自己想要的资源。





#### 操作系统层面上，锁是如何实现的？











### I/O

#### 有了解epoll吗？可以说说吗？



#### 操作系统的 IO 模型(阻塞，非阻塞，IO多路复用，信号驱动IO，异步IO)



#### 一次普通 IO 的过程，什么时候用到了系统调用



#### 介绍下 IO 多路复用



#### select poll 和 epoll 最大的差别是什么(第一阶段，等待数据报的到来，epoll 不会阻塞)







### Linux

Linux如何查看哪些端口建立tcp连接。netstate命令。这些端口都有哪些状态，(listien,established,time-wait等等)。为什么要有time-wait。



敲kill -9命令发生了什么。-9是什么意思

- kill -9 1050 ，表示给 PID 为 1050 的进程发送 `SIGKILL` 信号，用来立即结束该进程；



### 待分类

操作系统的临界区了解吗



大端和小端有什么区别？



用户态和内核态



read 在三者中是用户发起还是内核发起？(用户发起)







## 计算机网络

### 通用

OSI七层模型有哪些？【3】



802.3x 工作在几层，为什么



dns查找的过程



### http

浏览器输入url到出现画面的过程【4】



http和https的区别【3】



http 状态码介绍一下



https的过程【2】



get和post请求的区别【2】



每次请求，https 的公私钥固定不变吗？(第一次会协商和加密，之后同一个浏览器的话会用 session id 做 session key 的提取，可以看做固定不变)



https 在传输消息前多出了几次 RTT(2-7次)



http 报文介绍



http 报文头和报文体分隔符是什么？\r\n 是什么意思(回车+换行)



分别介绍 http 1.1 2.0 3.0







### TCP/UDP

tcp与udp的区别【2】



tcp为什么安全



tcp的超时重传机制



TCP三次握手、四次挥手，timewait，closewait状态【4】



为什么需要第四次挥手【3】





了解socket编程吗，【2】其中accept方法是什么



生成 tcp 和 udp socket有什么区别(在创建声明和 api 使用上均有区别)



socket 如何标识一个协议(sock_type)



tcp 和 udp 报文的区别(序号，确认号，数据偏移，标识符，窗口大小等)



如何设计一种机制在UDP上实现可靠传输？（确认和重传机制）补充？



tcp 可靠性，然后问十六位校验和怎么实现的



tcp 粘包【2】



TCP SYN 攻击



### 待分类



2MSL 的目的



不同协议能否监听同一个端口(可以)



为什么需要 非对称加密 和 对称加密



## 数据库

### Mysql

mysql的索引用的什么数据结构 ｜ mysql的索引底层是什么，除了B+树以外还有什么数据结构可以作为索引【3】



mysql 索引为什么用B+树



mysql索引了解，原理是什么？



Mysql的底层实现【2】



了解Mysql的悲观锁和乐观锁吗？简单介绍一下【2】





最左匹配原则。 怎么建立索引（我回答了最左匹配原则）【2】，面试官给了一个例子：查询一个student表，如果where条件中有性别和姓氏，应该选择哪个字段作为索引



### Redis

redis有哪些数据类型【2】



为什么要用redis？有考虑过redis失效，也就是服务宕机的情况吗？



redis缓存击穿，缓存穿透，缓存雪崩



redis 持久化的方式(RDB, AOF)【2】



### 哈希

hashmap原理



哈希索引【2】hash说一下？hash为什么不能范围查找？减少Hash冲突的办法？



哈希和B+树查询数据的时间复杂度（答了哈希O(1)，B+树$O(log_{m}n)$其实就是树高



跳表怎么实现



哈希表怎么实现，讲哈希冲突的时候讲了开放寻址法、拉链法，然后问除了这两个还有其他方法吗（不知道



红黑树，立刻说我红黑树不熟悉，然后就问了一个：红黑树是不是二叉平衡树，回答是特殊的平衡树，然后讲红黑树性质就没了





### 通用

如果删除索引出现问题了导致锁表怎么办？



说一下MVCC



覆盖索引和聚簇索引【2】



b + 树说一下？索引结构？



聚集索引和非聚集索引？



回表？怎么减少回表？回表出现错误怎么办



范围查找可以用索引嘛？（可以，但具体执行要看优化器如何优化）



连接操作join了解嘛？（左连接，右连接，内连接）



inner join连接操作怎么实现的？（大概讲了下流程，应该是问底层）



join的时间复杂度？（加索引和不加索引）



不加索引怎么优化连接操作？（大表在前，小表在后）还有嘛？（加缓存？不太确定）



LRU具体实现。（Hash和双向链表）



数据库binlog,redolog,undolog的区别。



底层硬盘宕掉怎么办



什么数据结构适合做索引，为什么适合做索引。（只说了B+树和hash，忘记了跳表。）





幻读是什么，解决方案



内部节点 和 叶子节点 满足一页数据页吗



主从同步（异步，半同步）





## 数据结构

红黑树和B+树的区别



B+树属于二叉树么



说一下拓扑排序



堆排序过程。时间复杂度。维护堆过程。堆中插入一个节点和删除一个节点的流程，时间空间复杂度。



你熟悉什么排序，各种排序的时间复杂度



堆排序建堆过程，建堆时间复杂度



需要几个栈实现一个队列，两个，口述压队出队



## Golang

### 通用

golang语言，它与其他语言的不同



函数传指针和传值有什么区别？



new和make有什么区别？



为什么Golang可以很容易实现高并发。



go的slice内部有什么？



go slice 和 array 区别



slice的扩容



make一个slice后返回的是指针吗？map呢？



一个函数传参一个slice，先append再赋值和另一个函数先赋值再append，哪个会发生变化？



go的map是线程安全的吗？



对象是什么。面向对象有什么好处。go的多态。





### 协程

golang中协程的概念，协程之间怎么通信



了解GMP模型吗，介绍一下？【2】



一组协程完成后需要通知其他协程，可以怎么办？（管道？）







### 管道

channel了解吗，channel的工作原理是什么？

向一个已经关闭的channel发送数据，会发生什么；从一个已经关闭的channel中接收数据，会发生什么



### GC

golang的GC【2】



三色标记法的灰色、黑色有什么区别？为什么区分灰色和黑色，灰色存在的意义？



写屏障是什么？





什么是内存逃逸，在什么情况下发生，原理是什么?





### 框架

Gin框架的中间件是怎么实现的？有了解吗？



Gin框架吧，为什么使用Gin框架？可以大概说一下Gin框架的具体实现吗？



Gin框架的路由树的实现。







## 通用

如果要设计一个秒杀系统，需要加锁？加到哪一层？代码？数据库？网关



有了解过微服务的基本原理吗？



微服务是怎么实现鉴别不同的服务的？



了解IO多路复用吗？可以说说大致的实现吗？



介绍下 jwt



## 算法题

最大岛屿数量



反转一个带符号的整数：-32变为-23.整数在[-2^31, 2^31-1]之间；需要注意输入数据的类型和是否结果会溢出



分苹果



求一个数组的所有可能的元素集合



二叉树中序遍历 



返回一个大数的阶乘结果，输入为字符串，输出也为字符串



二叉树转双向链表。



LC 394 字符串解码



 最长连续序列



有n个"("和")"，输出所有的排列组合



根节点到叶子节点路径和为目标值的路径



口述链表是否存在环。数学证明。过渡到如果快指针一次走三步行不行。【2】



一个数组，元素从两边到中间单调递增，找出元素种类的个数。[4,5,6,9,7,6,5,1] 结果应该返回6。面试的话应该空间复杂度O(1)才能通过（双指针？）



接雨水



删除链表中的重复元素2



字典序的第K小数字



去除链表中重复元素



最长的格式正确的括号字符串



输入 n，给出 1~n 的所有排列，不要求输出有序

即 输入 3，输出 1，2，3，12，13，23，123





## 智力题

烧绳子，接水。



32个球，重量都不一样，只有一个天平，需要多少次才能找到最终的？需要多少次才能找到第二重的？



## 场景题

设计一个邀请码，数字字母组成，固定长度，唯一，邀请码之间变化比较大。考虑了半天，说了个错误的。8会，想了解的同学可以参考base62编码规则。



两个大文件找重复行